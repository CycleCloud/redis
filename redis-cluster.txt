######################################
## Redis Cluster Configuration File ##
######################################

[parameters Cloud Provider Account]
    Order = 10
    [[parameter credentials]]
    Label = Credentials:
    Description = The credentials for the cloud provider
    ParameterType = Cloud.Credentials
    
    [[parameter keypair]]
    Label = Key pair:
    Description = The keypair to connect with
    ParameterType = AWS.Keypair
    DefaultValue = cyclecloud

    [[parameter keypair_location]]
    Label = Key pair location:
    Description = The path to the keypair
    DefaultValue = ~/.ssh/cyclecloud.pem

[parameters Redis Configuration]
    Order = 20
    
    [[parameter redis_description]]
    HideLabel = true
    Config.Plugin = pico.widget.HtmlTemplateWidget
    Config.Template = "Adjust the Redis configuration options.<br/>Recommended only for advanced users."


[parameters Compute Backend]
    Order = 40

    [[parameter enable_termination_protection]]
    Label = Termination Prot.?
    DefaultValue = false
    Widget.Plugin = pico.form.BooleanCheckBox
    Widget.Label = Enable Termination for all instances?
    
    
    [[parameter server_machine_type]]
    Label = Server MachineType
    Description = The machine type for the Redis Servers
    ParameterType = Cloud.MachineType
    Config.Provider = AWS
    DefaultValue = m3.large
    
[cluster redis]

    # Autoscale for Redis is out-of-scope for this example
    # If required, please contact CycleComputing for additional support
    Autoscale = false
    IconUrl = http://download.cyclecomputing.com/logos/redis-192x192.png

    [[node defaults]]
    TerminationProtection = $enable_termination_protection
    Image = Cycle CentOS 7

    KeyPair = $keypair
    KeyPairLocation = $keypair_location

    Credentials = $credentials
    ClusterInit = redis/0.1

    [[node server]]
    IsReturnProxy = true
    MachineType = $server_machine_type

        [[[configuration]]]
        cyclecloud.discoverable = true 
        redis.role = server    
        redis.port_list = 7000,7001,7002,7003,7004,7005
        redis.home = /mnt/scratch/redis



